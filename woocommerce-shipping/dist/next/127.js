
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b27d3b9a-7615-5cdf-a405-a05b11e12ae4")}catch(e){}}();
export const __webpack_esm_id__=127;export const __webpack_esm_ids__=[127];export const __webpack_esm_modules__={9127(e,i,s){s.d(i,{WooCommerceShippingSettings:()=>Ie});var r=s(4683),o=s(7723),n=s(6087),t=s(7143),a=s(3582),d=s(692),l=s(4573),c=s(8804),m=s(5075),p=s(450),h=s(5524),u=s(8931),g=s(4330),_=s(4810),x=s(7432),A=s(3760),y=s(9174),j=s(2936);const w=e=>e.id,f=({item:e})=>e.company||`${e.first_name} ${e.last_name}`,b=({item:e})=>`${e.address_1}, ${e.city}, ${e.state}, ${e.postcode}, ${e.country}`;var v=s(2784);const S={name:"address",kind:"root",baseURL:"/wcshipping/v2/addresses",label:(0,o.__)("Address","woocommerce-shipping"),plural:(0,o.__)("Addresses","woocommerce-shipping"),key:"id",supportsPagination:!1},C=[];var I=s(8468),k=s.n(I);(()=>{if(C.includes(S.name))return;const{addEntities:e}=(0,t.dispatch)(a.store);e([S]),C.push(S.name)})();var E=s(342),N=s(7401),D=s(4698),V=s(1609),T=s(1894),F=s(1938),P=s(8629),B=s(136),z=s(3398),O=s(7707),R=s(8846),L=s(5913),M=s(9388),U=s(7500),H=s(5264),Y=s(790);const q=(0,n.createContext)(),W=({children:e,initialValue:i})=>(0,Y.jsx)(q.Provider,{value:i,children:e});var $=s(6062),G=s(3258),J=s(435),K=s(3487);class X extends V.Component{constructor(e){super(e),this.state={hasError:!1,error:null,componentStack:null,eventId:""}}static getDerivedStateFromError(e){var i,s;return{hasError:!0,error:`${e?.toString()} \nFile name: ${null!==(i=e?.fileName)&&void 0!==i?i:"No fileName reported"} \nStack trace: ${null!==(s=e?.stack)&&void 0!==s?s:"No stack trace reported"}`}}componentDidCatch(e,i){console.warn("logging",{error:e,componentStack:i}),$.v4((()=>{const s=G.Cp(e,{captureContext:{contexts:{react:{componentStack:i}}}});this.setState({eventId:s,componentStack:i})}))}render(){const{onError:e,children:i}=this.props,{hasError:s,error:r}=this.state;return s?e?e(this.state):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("h4",{children:(0,n.createInterpolateElement)((0,o.__)("The component <mark/> encountered an error","woocommerce-shipping"),{mark:(0,Y.jsx)("mark",{children:V.Children.map(i,(e=>(0,D.Hi)(e)))?.join(", ")})})}),(0,Y.jsx)("p",{children:(0,n.createInterpolateElement)((0,o.__)("Please report the following error by <feedbackform>submitting a crash report</feedbackform> or contacting <a>WooCommerce Shipping Support</a>","woocommerce-shipping"),{feedbackform:(0,Y.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),J.mn({eventId:this.state.eventId})},children:(0,o.__)("submitting a crash report","woocommerce-shipping")}),a:(0,Y.jsx)(K.A,{href:"https://woocommerce.com/products/shipping/",children:(0,o.__)("WooCommerce Shipping Support","woocommerce-shipping")})})}),(0,Y.jsx)("code",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",overflowX:"auto"},children:r})]}):this.props.children}}V.Component;const Q=(e,i)=>s=>(s&&(e.displayName=s),function(s){return(0,Y.jsx)(X,{...i,children:(0,Y.jsx)(e,{...s})})});var Z=s(9523);const ee=Q((({group:e,errorCallback:i,originCountry:s})=>{const{isUpdating:r,validationErrors:t}=(0,n.useContext)(q),{values:a,getInputProps:d,getCheckboxControlProps:l,getSelectControlProps:c,errors:m}=(0,R.useFormContext)(),p=(0,D.zb)(e,a.country),h=a.country?(0,D.Y5)(a.country):[],u=(e,i)=>{var s,r;return null!=i||(i=d(e)),(null!==(s=t[e])&&void 0!==s?s:m[e])?{...i,help:null!==(r=t[e])&&void 0!==r?r:m[e],className:"has-error"}:i};(0,n.useEffect)((()=>{"general"in t&&i(t.general)}),[i,t]);const g=(0,D.eI)({type:e,originCountry:s,destinationCountry:a.country});return(0,Y.jsx)("div",{children:(0,Y.jsxs)(F.A,{direction:"column",children:[(0,Y.jsx)(L.A,{...u("name"),label:(0,o.__)("Name","woocommerce-shipping"),required:!a.company||a.name,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(P.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(L.A,{...u("company"),label:(0,o.__)("Company","woocommerce-shipping"),required:!a.name,disabled:r,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(P.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(B.A,{children:(0,Y.jsxs)(F.A,{children:[(0,Y.jsx)(M.A,{children:(0,Y.jsx)(L.A,{...u("email"),label:(Z.Ld.ORIGIN,(0,o.__)("Email address","woocommerce-shipping")),disabled:r,required:g,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),(0,Y.jsx)(M.A,{children:(0,Y.jsx)(L.A,{...u("phone"),label:(Z.Ld.ORIGIN,(0,o.__)("Phone","woocommerce-shipping")),placeholder:(0,o.__)("e.g., +1 (212) 555-0123 or 2125550123","woocommerce-shipping"),disabled:r,required:g,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})})]})}),(0,Y.jsx)(P.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(U.A,{label:(0,o.__)("Country","woocommerce-shipping"),options:p,...u("country",c("country")),disabled:r||!1,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(P.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(L.A,{label:(0,o.__)("Address","woocommerce-shipping"),...u("address"),disabled:r,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(P.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(L.A,{label:(0,o.__)("City","woocommerce-shipping"),...u("city"),disabled:r,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(P.A,{marginTop:0,marginBottom:1}),(0,Y.jsxs)(B.A,{direction:"column",children:[(0,Y.jsxs)(F.A,{children:[(0,Y.jsx)(M.A,{children:(0,Y.jsx)(L.A,{label:(0,o.__)("State","woocommerce-shipping"),...u("state",c("state")),disabled:r,required:h.length>0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),(0,Y.jsx)(M.A,{children:(0,Y.jsx)(L.A,{label:(0,o.__)("Postal code","woocommerce-shipping"),...u("postcode"),disabled:r,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})})]}),e===Z.Ld.ORIGIN&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(F.A,{children:(0,Y.jsx)(M.A,{children:(0,Y.jsx)(H.A,{label:(0,o.__)("Save as default origin address","woocommerce-shipping"),disabled:r,...u("defaultAddress",l("defaultAddress")),__nextHasNoMarginBottom:!0})})}),(0,Y.jsx)(F.A,{children:(0,Y.jsx)(M.A,{children:(0,Y.jsx)(H.A,{label:(0,o.__)("Save as default return address","woocommerce-shipping"),disabled:r,...u("defaultReturnAddress",l("defaultReturnAddress")),__nextHasNoMarginBottom:!0})})})]})]})]})})}))("AddressFields");var ie=s(1606),se=s(3881),re=s(6957),oe=s(9682);const ne=Q((({warnings:e,originalAddress:i,normalizedAddress:s,editAddress:r,confirmAddress:t,errors:a,nextDesign:d=!1})=>{const[l,c]=(0,n.useState)(s?"normalized":"original"),m=s?(0,o.__)("We have slightly modified the address entered. If correct, please use the suggested address to ensure accurate delivery.","woocommerce-shipping"):(0,o.__)("We were unable to verify the address entered. It may still be a valid address, but we cannot ensure accurate delivery to this address as entered. Please confirm if you would like to continue with the address as entered or return to edit the address.","woocommerce-shipping"),p=s?(0,o.__)("Use selected address","woocommerce-shipping"):(0,o.__)("Confirm unverified address","woocommerce-shipping");return d?(0,Y.jsxs)("div",{children:[(0,Y.jsx)(P.A,{marginBottom:4,children:(0,Y.jsxs)(F.A,{justify:"space-between",align:"flex-start",children:[(0,Y.jsx)(g.A,{as:"h2",size:20,weight:500,children:(0,o.__)("Confirm Address","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{icon:oe.A,onClick:()=>r(),title:(0,o.__)("Close modal","woocommerce-shipping"),style:{padding:0,minWidth:"24px",height:"24px"}})]})}),(0,Y.jsxs)(P.A,{style:{minHeight:"448px"},paddingY:6,children:[a.general&&(0,Y.jsx)(T.A,{status:"error",isDismissible:!1,children:a.general}),(0,Y.jsxs)(P.A,{marginBottom:8,children:[(0,Y.jsx)(T.A,{status:"warning",isDismissible:!1,children:(0,o.__)("We found a similar address, Please review the suggestion below, or proceed with your original address.","woocommerce-shipping")}),!!e&&e.length>0&&e.map((({code:e,message:i})=>(0,Y.jsxs)("div",{children:[(0,Y.jsx)(P.A,{marginBottom:2}),(0,Y.jsx)(T.A,{status:"warning",isDismissible:!1,children:(0,Y.jsx)(F.A,{align:"center",justify:"left",children:(0,Y.jsx)(g.A,{children:i})})})]},e)))]}),(0,Y.jsx)(j.De,{data:{selectedAddress:l},onChange:e=>c(e.selectedAddress),form:{layout:{type:"regular",labelPosition:"top"},fields:["selectedAddress"]},fields:[{id:"selectedAddress",type:"text",Edit:"radio",label:(0,o.__)("Choose an address","woocommerce-shipping"),elements:[{label:(0,o.__)("Keep my address","woocommerce-shipping"),value:"original",description:(0,D.pD)(i)},{label:(0,o.__)("Suggested address","woocommerce-shipping"),value:"normalized",description:s?(0,D.pD)(s):void 0}]}]})]}),(0,Y.jsx)(P.A,{marginBottom:4}),(0,Y.jsxs)(F.A,{justify:"flex-end",align:"center",as:"footer",children:[(0,Y.jsx)(y.Ay,{onClick:r,variant:"tertiary",children:(0,o.__)("Edit address","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:()=>t("normalized"===l),variant:"primary",children:p})]})]}):(0,Y.jsxs)("div",{children:[a.general&&(0,Y.jsx)(T.A,{status:"error",isDismissible:!1,children:a.general}),(0,Y.jsx)("p",{children:m}),!!e&&e.length>0&&e.map((({code:e,message:i})=>(0,Y.jsx)(T.A,{status:"warning",isDismissible:!1,children:(0,Y.jsxs)(F.A,{align:"center",justify:"left",children:[(0,Y.jsx)(ie.A,{icon:O.A,fill:"#f0b849",style:{minWidth:"20px",alignSelf:"center",justifyContent:"left"}}),(0,Y.jsx)(g.A,{children:i})]})},e))),(0,Y.jsxs)(se.A,{onChange:c,value:l,justify:"space-between",gap:4,children:[(0,Y.jsxs)(F.A,{direction:"column",gap:2,children:[(0,Y.jsx)("strong",{children:(0,o.__)("What you entered","woocommerce-shipping")}),(0,Y.jsx)(re.A,{value:"original",label:(0,D.pD)(i)})]}),(0,Y.jsx)(F.A,{direction:"column",gap:2,children:s&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("strong",{children:(0,o.__)("Suggested","woocommerce-shipping")}),(0,Y.jsx)(re.A,{value:"normalized",label:(0,D.pD)(s)})]})})]}),(0,Y.jsxs)(F.A,{justify:"flex-end",as:"footer",children:[(0,Y.jsx)(y.Ay,{onClick:r,variant:"tertiary",children:(0,o.__)("Edit address","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:()=>t("normalized"===l),variant:"primary",children:p})]})]})}))("AddressSuggestion");var te=s(9315),ae=s(2502),de=s(5180),le=s(1504),ce=s(9016),me=s(3526);function pe({className:e,intent:i="default",children:s,hideIcon:r=!1,noEllipsis:o=!1,...n}){const t=function(e="default"){switch(e){case"info":return de.A;case"success":return le.A;case"warning":case"warning-alt":return O.A;case"error":return ce.A;default:return null}}(i),a=!r&&!!t;return(0,Y.jsxs)("span",{className:(0,me.A)("components-badge",e,{[`is-${i}`]:i,"has-icon":a,"woocommerce-status-badge":"warning-alt"===i,"is-actionable":"warning-alt"===i}),...n,style:{userSelect:"none",flexShrink:o?0:1,lineHeight:"inherit"},children:[a&&(0,Y.jsx)(ie.A,{icon:t,size:16,fill:"currentColor",className:"components-badge__icon"}),(0,Y.jsx)("span",{className:"components-badge__content",children:s})]})}const he=({isVerified:e,isFormChanged:i=!1,isFormValid:s=!0,errorMessage:r=(0,o.__)("Unverified address","woocommerce-shipping"),onClick:n,message:a=(0,o.__)("Address verified","woocommerce-shipping"),addressType:d,nextDesign:l=!1})=>{const c=(0,t.useSelect)((e=>e(te.Y).getIsAddressVerificationInProgress(d)),[d]);return e&&!i&&s&&!c?!l&&(0,Y.jsxs)("span",{className:"verification",children:[(0,Y.jsx)(ie.A,{icon:ae.A,size:16}),a]}):c?l?(0,Y.jsx)(pe,{intent:"info",hideIcon:!0,noEllipsis:!0,children:(0,o.__)("Validating…","woocommerce-shipping")}):(0,Y.jsxs)("span",{className:"verification in-progress",children:[(0,Y.jsx)(ie.A,{icon:ae.A,size:16}),(0,o.__)("Verifying address…","woocommerce-shipping")]}):l?(0,Y.jsx)(pe,{intent:"warning",hideIcon:!0,noEllipsis:!0,children:r}):(0,Y.jsx)("span",{className:"verification not-verified",children:n?(0,Y.jsx)(y.Ay,{variant:"link",icon:de.A,onClick:e=>n?.(e),title:r,children:r}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(ie.A,{icon:de.A,size:22}),r]})})};var ue=s(5919),ge=s(1495),_e=s(9334);function xe({data:e,field:i,onChange:s,hideLabelFromVision:r}){const o="address"===i.id?e.address1||e.address:e[i.id];return(0,Y.jsx)(_e.Ay,{value:o,label:i.label,onChange:e=>{s({[i.id]:e})},placeholder:i.placeholder,hideLabelFromVision:r,__next40pxDefaultSize:!0})}function Ae({data:e,field:i,onChange:s,options:r,hideLabelFromVision:o}){const n=e[i.id];return(0,Y.jsx)(U.A,{value:n,options:r,label:i.label,hideLabelFromVision:o,onChange:e=>{s({[i.id]:e})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}function ye({data:e,field:i,onChange:s}){const r=e[i.id];return(0,Y.jsx)(H.A,{label:i.label,checked:r,onChange:e=>{s({[i.id]:e})}})}function je({type:e,initialValue:i,onSubmit:s,onCancel:r,isUpdating:t,isVerified:a,validationErrors:d,showUPSDAPTOSWarning:l,validateAddressSection:c,isSubmitButtonDisabled:m,originCountry:p}){const[h,u]=(0,n.useState)(i),[_,x]=(0,n.useState)(!1),[A,w]=(0,n.useState)({}),f={...d,...A},b=0===Object.keys(A).length,v=(0,n.useMemo)((()=>(0,D.zb)(e,h.country)),[e,h.country]),S=(0,n.useMemo)((()=>h.country?(0,D.Y5)(h.country):[]),[h.country]),C=(0,n.useMemo)((()=>(0,D.eI)({type:e,originCountry:p,destinationCountry:h.country})),[e,p,h.country]),I=(0,n.useMemo)((()=>[{id:"name",type:"text",label:e===Z.Ld.DESTINATION?(0,o.__)("Recipient Name","woocommerce-shipping"):(0,o.__)("Name","woocommerce-shipping")},{id:"company",type:"text",label:(0,o.__)("Company","woocommerce-shipping"),isVisible:()=>e===Z.Ld.ORIGIN},{id:"address",type:"text",placeholder:(0,o.__)("Address","woocommerce-shipping"),label:e===Z.Ld.DESTINATION?(0,o.__)("Shipping Address","woocommerce-shipping"):(0,o.__)("Address","woocommerce-shipping")},{id:"address2",type:"text",placeholder:(0,o.__)("Apartment, suite, etc.","woocommerce-shipping"),isVisible:()=>e===Z.Ld.DESTINATION,Edit:e=>(0,Y.jsx)(xe,{...e,hideLabelFromVision:!0})},{id:"city",type:"text",placeholder:(0,o.__)("City","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(xe,{...e,hideLabelFromVision:!0})},{id:"state",type:"text",label:(0,o.__)("State","woocommerce-shipping"),placeholder:(0,o.__)("State","woocommerce-shipping"),Edit:e=>S.length>0?(0,Y.jsx)(Ae,{...e,options:S,hideLabelFromVision:!0}):(0,Y.jsx)(xe,{...e,hideLabelFromVision:!0})},{id:"postcode",type:"text",placeholder:(0,o.__)("Postal Code","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(xe,{...e,hideLabelFromVision:!0})},{id:"country",type:"text",label:(0,o.__)("Country","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(Ae,{...e,options:v,hideLabelFromVision:!0})},{id:"email",type:"text",label:C?(0,o.__)("Email","woocommerce-shipping"):(0,o.__)("Email (optional)","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(xe,{...e})},{id:"phone",type:"text",label:(0,o.__)("Phone","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(xe,{...e})},{id:"defaultAddress",type:"boolean",label:(0,o.__)("Save as default origin address","woocommerce-shipping"),isVisible:()=>e===Z.Ld.ORIGIN,Edit:e=>(0,Y.jsx)(ye,{...e})},{id:"defaultReturnAddress",type:"boolean",label:(0,o.__)("Save as default return address","woocommerce-shipping"),isVisible:()=>e===Z.Ld.ORIGIN,Edit:e=>(0,Y.jsx)(ye,{...e})}]),[v,S,C,e]),E={fields:["name","company",{id:"emailPhoneRow",layout:{type:"row"},children:["email","phone"]},"address","address2",{id:"cityStateRow",layout:{type:"row"},children:["city","state"]},{id:"postcodeCountryRow",layout:{type:"row"},children:["postcode","country"]},"defaultAddress","defaultReturnAddress"].filter(Boolean)},N=(0,n.useCallback)((e=>{u((i=>({...i,...e})))}),[u]);return(0,n.useEffect)((()=>{x(!k().isEqual(i,h));const e=c(h);w(e)}),[h,c]),(0,Y.jsxs)(Y.Fragment,{children:[l&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(T.A,{status:"warning",isDismissible:!1,children:(0,Y.jsx)(g.A,{children:(0,o.__)("You have accepted the UPS® Terms of Service for this address. If you update the address, the acceptance will be revoked, and you will need to accept the Terms of Service again before purchasing additional UPS® labels.","woocommerce-shipping")})}),(0,Y.jsx)(P.A,{marginBottom:3})]}),!a&&(0,Y.jsx)(P.A,{marginBottom:3,children:(0,Y.jsx)(T.A,{status:"warning",isDismissible:!1,children:(0,o.__)("This address hasn't been validated. We recommend validating to help ensure successful delivery.","woocommerce-shipping")})}),Object.keys(f).length>0&&(0,Y.jsx)(P.A,{marginBottom:3,children:(0,Y.jsxs)(T.A,{status:"error",isDismissible:!1,children:[(0,Y.jsx)(g.A,{children:(0,o.__)("Please fix the errors below to continue.","woocommerce-shipping")}),(0,Y.jsx)("ul",{style:{margin:0,paddingInlineStart:0,listStylePosition:"inside"},children:[...new Set(Object.values(f).filter((e=>"string"==typeof e)))].map((e=>(0,Y.jsx)("li",{children:e},e)))})]})}),(0,Y.jsx)(W,{initialValue:{isUpdating:t,validationErrors:d},children:(0,Y.jsx)(P.A,{marginBottom:6,children:(0,Y.jsx)(j.De,{data:h,fields:I,onChange:N,form:E})})}),(0,Y.jsxs)(F.A,{justify:"flex-end",align:"center",as:"footer",children:[(0,Y.jsx)(y.Ay,{onClick:r,isBusy:t,variant:"tertiary",children:(0,o.__)("Cancel","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:async()=>{await s(h)},variant:"primary",disabled:m({isDirty:_,isValidForm:b}),isBusy:t,children:(0,o.__)("Validate and save","woocommerce-shipping")})]})]})}const we=Q((({type:e,address:i,onCompleteCallback:s,onCancelCallback:r,isAdd:a=!1,orderId:d,originCountry:l,nextDesign:c=!1})=>{const[m,p]=(0,n.useState)(!1),[h,u]=(0,n.useState)(!1),[_,x]=(0,n.useState)(!1),[A,j]=(0,n.useState)(!1),[w,f]=(0,n.useState)((0,o.__)("Unvalidated address","woocommerce-shipping")),[b,v]=(0,n.useState)(!1),[S,C]=(0,n.useState)(null);if(e===Z.Ld.DESTINATION&&!d)throw new Error("Order id is required for destination address");if(a&&e===Z.Ld.DESTINATION)throw new Error("Destination address cannot be added");const k=i=>[{values:i,errors:(0,D.HI)(),type:e}].map((i=>(0,D.Rv)((0,D.eI)({type:e,originCountry:l,destinationCountry:i.values.country}))(i))).map(D.Lj).map(D.DT).map(D.jn).map(D.ib).map((i=>e===Z.Ld.DESTINATION&&l?(0,D.lP)(l)(i):(0,D.FY)(i)))[0].errors,N=(0,t.useSelect)((i=>i(te.Y).getFormErrors(e)),[e]),V=(0,t.useSelect)((i=>i(te.Y).getSubmittedAddress(e)),[e]),L=(0,t.useSelect)((i=>i(te.Y).getIsAddressVerified(e)),[e]),M=(0,t.useSelect)((i=>i(te.Y).getNormalizedAddress(e)),[e]),U=(0,t.useSelect)((i=>i(te.Y).getAddressNeedsConfirmation(e)),[e]),H=(0,t.useSelect)((e=>e(te.Y).getAddressVerifcationWarnings(Z.Ld.DESTINATION)),[]),q=async i=>{var s;u(!0),await(0,t.dispatch)(te.Y).normalizeAddress({address:{...i,address1:null!==(s=i.address)&&void 0!==s?s:"",address2:""}},e),u(!1)},$=e=>{var i;return{...e,address1:null!==(i=e.address)&&void 0!==i?i:"",address2:""}},G=async(i,s)=>{u(!0);try{a?await(0,t.dispatch)(te.Y).addOriginAddress($(i)):await(0,t.dispatch)(te.Y).updateShipmentAddress({orderId:null!=d?d:"",address:$(i),isVerified:s},e),j(!0)}finally{u(!1)}},J=async e=>{C(e),v(!0)},K=()=>{v(!1),C(null)},X=()=>{p(!1),x(!1)};(0,n.useEffect)((()=>{U&&!_&&(x(!0),p(!0),(0,t.dispatch)(te.Y).resetAddressNormalizationResponse(e))}),[U,_,e]),(0,n.useEffect)((()=>{A&&(0,I.isEmpty)(N)&&s(i),(0,I.isEmpty)(N)||j(!1)}),[i,A,N,s]);const Q=({isDirty:e,isValidForm:i})=>!(!L||i&&e),ie=(0,t.useSelect)((s=>e!==Z.Ld.DESTINATION&&s(ge.F).getUPSDAPCarrierStrategyForAddressId(i.id).hasAgreedToTos),[i.id,e]),se=!a&&ie;return(0,Y.jsxs)("div",{children:[c?(0,Y.jsx)(Y.Fragment,{children:!m&&(0,Y.jsx)(je,{type:e,initialValue:{...i},onSubmit:q,onCancel:r,isUpdating:h,isVerified:L,validationErrors:N,showUPSDAPTOSWarning:se,validateAddressSection:k,isSubmitButtonDisabled:Q,originCountry:l,onSaveWithoutValidation:J})}):(0,Y.jsx)(R.Form,{validate:k,initialValues:i,onSubmit:async e=>{(0,ue.Jq)(i,e)&&L?await G(e,!0):await q(e)},children:({isValidForm:s,handleSubmit:n,isDirty:t,values:a})=>(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(W,{initialValue:{isUpdating:h,validationErrors:N},children:[se&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(T.A,{status:"warning",isDismissible:!1,children:(0,Y.jsxs)(F.A,{align:"flex-start",children:[(0,Y.jsx)(z.A,{icon:O.A,style:{minWidth:"20px"}}),(0,Y.jsx)(g.A,{children:(0,o.__)("You have accepted the UPS® Terms of Service for this address. If you update the address, the acceptance will be revoked, and you will need to accept the Terms of Service again before purchasing additional UPS® labels.","woocommerce-shipping")})]})}),(0,Y.jsx)(P.A,{marginBottom:3})]}),(0,Y.jsx)("p",{children:(0,o.__)("Please complete all required fields and click the 'Validate and save' button below to confirm and validate your address details.","woocommerce-shipping")}),(0,Y.jsx)(ee,{group:e,errorCallback:f,originCountry:l})]}),(0,Y.jsxs)(F.A,{justify:"space-between",as:"footer",children:[(0,Y.jsx)(he,{isVerified:L,isFormChanged:t&&!(0,ue.Jq)(i,a),isFormValid:s,errorMessage:w,addressType:Z.Ld.ORIGIN}),(0,Y.jsx)(B.A,{children:(0,Y.jsxs)(F.A,{gap:2,children:[(0,Y.jsx)(y.Ay,{onClick:r,isBusy:h,variant:"tertiary",children:(0,o.__)("Cancel","woocommerce-shipping")}),!(0,I.isEmpty)(N)&&!M&&(0,Y.jsx)(y.Ay,{onClick:()=>J(a),isBusy:h,variant:"secondary",children:(0,o.__)("Save without validating","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:n,disabled:Q({isValidForm:s,isDirty:t}),isBusy:h,variant:"primary",children:(0,o.__)("Validate and save","woocommerce-shipping")})]})})]})]})}),m&&V&&M&&(0,Y.jsx)(E.A,{className:"address-suggestion-modal",onRequestClose:X,focusOnMount:!0,shouldCloseOnClickOutside:!1,title:(0,o.__)("Confirm address","woocommerce-shipping"),__experimentalHideHeader:c,size:c?"medium":void 0,children:(0,Y.jsx)(ne,{warnings:H,originalAddress:V,normalizedAddress:M,editAddress:X,confirmAddress:async i=>{p(!1),u(!0),M&&V&&(M.email=V.email,M.phone=V.phone,M.defaultAddress=V.defaultAddress,M.defaultReturnAddress=V.defaultReturnAddress);const s=i?M:V;s?(a?await(0,t.dispatch)(te.Y).addOriginAddress(s):await(0,t.dispatch)(te.Y).updateShipmentAddress({orderId:null!=d?d:"",address:s,isVerified:!0},e),u(!1),x(!1),j(!0)):console.warn(`No address to update for ${e}, address: ${s}`)},errors:N,nextDesign:c})}),b&&(0,Y.jsxs)(E.A,{title:(0,o.__)("Save without validation?","woocommerce-shipping"),onRequestClose:K,shouldCloseOnClickOutside:!1,children:[(0,Y.jsx)("p",{children:(0,o.__)("This address could not be validated. Proceeding without validation may result in delivery delays or failures.","woocommerce-shipping")}),(0,Y.jsxs)(F.A,{justify:"flex-end",gap:2,children:[(0,Y.jsx)(y.Ay,{variant:"tertiary",onClick:K,children:(0,o.__)("Cancel","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{variant:"primary",onClick:async()=>{S&&(v(!1),await G(S,!1),C(null))},children:(0,o.__)("Save anyway","woocommerce-shipping")})]})]})]})}))("AddressStep"),fe=((0,o.__)("Name","woocommerce-shipping"),(0,o.__)("Company","woocommerce-shipping"),(0,o.__)("Email Address","woocommerce-shipping"),(0,o.__)("mail@example.com","woocommerce-shipping"),(0,o.__)("Phone","woocommerce-shipping"),(0,o.__)("123456789","woocommerce-shipping"),(0,o.__)("Country","woocommerce-shipping"),Object.entries({US:"United States",PR:"Puerto Rico",VI:"Virgin Islands",GU:"Guam",AS:"American Samoa",UM:"United States Minor Outlying Islands",MH:"Marshall Islands",FM:"Micronesia",MP:"Northern Mariana Islands"}).map((([e,i])=>({value:e,label:i}))),(0,o.__)("Address","woocommerce-shipping"),(0,o.__)("Address","woocommerce-shipping"),(0,o.__)("City","woocommerce-shipping"),(0,o.__)("State","woocommerce-shipping"),(0,o.__)("Postal Code","woocommerce-shipping"),(0,o.__)("Save as default origin address","woocommerce-shipping"),{country:"US"}),be=({addressId:e,onClose:i,onComplete:s})=>{const r=(0,t.useSelect)((e=>e(Z.zD).getOriginAddresses()),[]).find((i=>i.id===e)),n=!r;return(0,Y.jsx)(E.A,{size:"medium",onRequestClose:i,title:n?(0,o.__)("Add address","woocommerce-shipping"):(0,o.__)("Edit address","woocommerce-shipping"),children:(0,Y.jsx)(we,{type:"origin",address:(0,D.Tz)((0,D.nS)((0,D.fy)(null!=r?r:fe))),onCompleteCallback:s,onCancelCallback:i,isAdd:!r,nextDesign:!0})})},ve=e=>(0,v.hy)()?(0,Y.jsx)(be,{...e}):(0,Y.jsx)(E.A,{size:"medium",onRequestClose:e.onClose,children:(0,Y.jsx)(N.Ay,{})}),{useEntityRecordsWithPermissions:Se}=(0,v.Tl)(a.privateApis),Ce=()=>{const[e,i]=(0,n.useState)(!1),[s,r]=(0,n.useState)();(0,v.hy)();const{deleteEntityRecord:C,invalidateResolution:I}=(0,t.useDispatch)(a.store),{createSuccessNotice:k,createErrorNotice:E}=(0,t.useDispatch)(d.store),{records:N,isResolving:D}=Se(S.kind,S.name),{canUser:V}=(0,t.useSelect)(a.store,[]),T=V("create",{kind:S.kind,name:S.name}),F=e=>{r(e),i(!0)},P=async()=>{i(!1),r(void 0)};return(0,Y.jsxs)(m.A,{children:[e&&(0,Y.jsx)(ve,{onClose:P,onComplete:async()=>{await P(),k(s?(0,o.__)("Address updated","woocommerce-shipping"):(0,o.__)("Address added","woocommerce-shipping"),{type:"snackbar"}),I("getEntityRecords",[S.kind,S.name,{}])},addressId:s}),(0,Y.jsx)(p.A,{isBorderless:!0,children:(0,Y.jsxs)(h.A,{children:[(0,Y.jsx)(u.A,{level:4,weight:"normal",children:(0,o.__)("Ship-from location","woocommerce-shipping")}),(0,Y.jsx)(g.A,{variant:"muted",children:(0,o.__)("This address is used to calculate shipping rates and delivery times.","woocommerce-shipping")})]})}),(0,Y.jsxs)(_.A,{children:[(0,Y.jsx)(j.Vw,{isLoading:D,data:N,getItemId:w,defaultLayouts:{list:{}},fields:[{id:"title",getValue:e=>(0,Y.jsxs)(x.A,{spacing:2,alignment:"left",children:[(0,Y.jsx)(g.A,{weight:500,children:f(e)}),e.item.default_address&&(0,Y.jsx)(pe,{children:(0,o.__)("Default Origin","woocommerce-shipping")}),e.item.default_return_address&&(0,Y.jsx)(pe,{children:(0,o.__)("Default Return","woocommerce-shipping")})]})},{id:"detail",getValue:b}],onChangeView:()=>null,paginationInfo:{totalItems:N.length,totalPages:1},actions:[{id:"edit",isPrimary:!0,icon:l.A,label:(0,o.__)("Edit","woocommerce-shipping"),isEligible:()=>!!T,callback:([e])=>F(e.id)},{id:"delete",label:(0,o.__)("Delete","woocommerce-shipping"),isEligible:e=>!e.default_address&&!!T,callback:([e])=>(async e=>{try{await C(S.kind,S.name,e,{throwOnError:!0}),k((0,o.__)("Address deleted","woocommerce-shipping"),{type:"snackbar"})}catch{E((0,o.__)("Error deleting address","woocommerce-shipping"),{type:"snackbar"})}})(e.id)}],onChangeSelection:e=>{F(e[0])},view:{fields:["detail"],type:"list",titleField:"title"},children:(0,Y.jsx)(j.Vw.Layout,{})}),(0,Y.jsx)(A.A,{isBorderless:!0,size:"small",children:(0,Y.jsx)(y.Ay,{variant:"tertiary",icon:c.A,disabled:!T,onClick:()=>{i(!0)},children:(0,o.__)("Add another","woocommerce-shipping")})})]})]})},Ie=()=>(0,Y.jsx)(r.A,{columns:1,gap:8,justify:"center",templateColumns:"660px",children:(0,Y.jsx)(Ce,{})})}};
//# sourceMappingURL=127.js.map?v=11618d2d9a17f9ca67ac
//# debugId=b27d3b9a-7615-5cdf-a405-a05b11e12ae4
